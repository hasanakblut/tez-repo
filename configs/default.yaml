# =============================================================================
# GA-Dueling DQN — Default Configuration
# =============================================================================
# Central parameter file for all modules (env, model, agent, train).
# Paper: Xia et al., Sensors 2024, 24, 1325.
# =============================================================================

# -----------------------------------------------------------------------------
# Run / Reproducibility
# -----------------------------------------------------------------------------
device_id: 0
use_multi_gpu: false
seed: 42
same_episode_seed: true

# -----------------------------------------------------------------------------
# 1) Episode, Hyperparameters, Network, Environment
# -----------------------------------------------------------------------------
episode:
  max_pulses: 10000   # Pulses per episode (one pulse train)
  num_episodes: 100   # Total training episodes

environment:
  history_len: 10     # Observation history buffer length for GRU input

network:
  state_dim: 240      # Input dimension (index space = K! × M = 24 × 10)
  action_dim: 240     # Output dimension (number of actions)
  use_embedding: false  # false → one-hot input, GRU(240,128) per paper Table 2
  embed_dim: 64       # Only used when use_embedding=true; GRU input size
  hidden_dim: 128     # GRU hidden size (paper Table 2)
  num_heads: 8        # Multi-head attention heads (paper Table 2)
  fc_dim: 64          # FC1 and FC2 width (paper Table 2)
  sigma_init: 0.5     # NoisyLinear initial noise scale

training:
  gamma: 0.9
  learning_rate: 0.009
  batch_size: 256
  epsilon_start: 0.1
  epsilon_end: 0.005
  epsilon_decay_mode: "per_step"      # per_episode = once per episode; per_step = every env step (use epsilon_decay_steps)
  epsilon_decay_episodes: 100         # used when mode=per_episode
  epsilon_decay_steps: 1000000        # used when mode=per_step (e.g. 100*10k pulses)
  target_update_freq: 1

# -----------------------------------------------------------------------------
# 2) Radar — Generator mode and method parameters
# -----------------------------------------------------------------------------
radar:
  generator_mode: "markov"    # uniform | periodic | lcg | markov | markov_subband
  reset_generator_on_episode: true
  periodic_sequence: [0, 24, 48, 72, 96, 120, 144, 168, 192, 216]
  lcg_params:
    a: 1103515245
    c: 12345
    m: 2147483648
  markov_params:
    sparsity: 0.1
    delta_limit: 20
  markov_subband_params:
    stay_prob: 0.7
    sparsity: 0.1
    sigma_subband: 1.5
  start_index: 0
  random_start_index: true
  markov_transition_path: "results/markov_matrices/markov_P_deterministic_cycle_seed42.npy"
  # --- Fixed radar values (M, K, frequency bounds) ---
  M: 10              # Number of subbands
  K: 4               # Sub-pulses per pulse
  f_low: 10.0e+9     # Lower frequency bound (Hz) — 10 GHz
  f_high: 11.0e+9    # Upper frequency bound (Hz) — 11 GHz
  # Derived: B = 1 GHz, delta_f = 100 MHz, sub-pulse BW = 25 MHz; state_dim = M × K! = 240

# -----------------------------------------------------------------------------
# 3) Prioritized Experience Replay
# -----------------------------------------------------------------------------
replay:
  buffer_size: 100000
  alpha: 0.6
  beta_start: 0.4
  beta_end: 1.0
  beta_anneal_episodes: 100
  min_priority: 1.0e-6

# -----------------------------------------------------------------------------
# 4) Logging & Plotting
# -----------------------------------------------------------------------------
logging:
  log_interval: 1
  save_interval: 10
  plot_interval: 10
  results_dir: "results"
  use_tensorboard: true    # TensorBoard ile interaktif metrik takibi
  verbose_terminal: false  # true: her 500 pulse'ta terminale yaz; false: sadece episode özeti (TensorBoard kullanırken)

# -----------------------------------------------------------------------------
# 6) Radar — Physical parameters (Paper Table 1)
# -----------------------------------------------------------------------------
physics:
  A_R: 1.0           # Radar pulse amplitude (V)
  A_J: 5.0           # Jammer pulse amplitude (V)
  h_t: 0.1           # Radar-target channel gain
  h_j: 0.1           # Radar-jammer channel gain
  sigma: 0.1         # Target RCS (m²)
  L: 0.05            # Sidelobe loss
